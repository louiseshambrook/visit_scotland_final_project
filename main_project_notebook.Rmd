---
title: "Visit Scotland Final Project"
output: html_notebook
author: "Louise Shambrook"
---

### Loading required libraries
```{r}
library(tidyverse)
library(janitor)
library(lubridate)
```

### Loading cleaned data
```{r}
activities <- read_csv("clean_data/activities_clean.csv")
accomodation <- read_csv("clean_data/accomodation_clean.csv")
demographics <- read_csv("clean_data/demographics_clean.csv")
location <- read_csv("clean_data/location_clean.csv")
regional_domestic <- read_csv("clean_data/regional_domestic_clean.csv")
transport <- read_csv("clean_data/transport_clean.csv")
```

### Notes on data cleaning
I will be removing the feature_code from all datasets, as this is the country code for Scotland. I will also be removing the column measurement, as this is irrelevant and duplicated information. 

On all datasets, there is an "All" response. The data are survey responses, and therefore it is reasonable to assume that "all" was an actual response. Therefore, I will not drop it / change it to NA, but it also does not give any insight to my analysis and I will be removing it from my plots etc.

For most of the datasets, I have simplified the units and reordered the columns, so the datasets are easier to interpret.

For the activities dataset, I have simplified the responses, and dropped the original column.

For the transport dataset, I have grouped the types, and dropped the original column.

For the regional_domestic dataset, I have split the unit column into the nights/visits, and pounds, as the nights/visits are measured in thousands, and the pounds are measured in millions.

For the location dataset, I have also simplified the responses, and dropped the original column. 


### Business questions / main questions

- What kind of tourism activity generates the highest income for Scotland?
- Which kind of activity generates the most visits to sites?
- Is there a particular key demographic of visitors we should be focusing on? Who spends the most? Who visits the most?
- What type of locations receive the most visits? What kinds of locations do people spend the most in?
- Is there a particular method of travel our visitors arrive by? Some of our locations are remote and not easily accessible by public transport, so this would be good information to have.
- When looking at regional tourism, what insights can we gain? Where are our visitors from? How do they differ in the money they spend, nights they spend in Scotland, or number of visits they do?
- What type of accomodation is most popular? Is there a difference by location?
- How have general tourism rates changed over time?
- Is there any way to predict spending and visits for Visit Scotland?

### Notes on Visit Scotland


### Data wrangling / Exploratory data analysis

```{r}
summary(accomodation)
summary(activities)
summary(demographics)
summary(domestic_tourism)
summary(location)
summary(transport)
# checking for NA values (aside from the "all" values)

head(activities)
head(location)
head(transport)
head(domestic_tourism)
head(accomodation)
```

## Q1.
```{r}
# What kind of tourism activity generates the highest income for Scotland?
activities %>%
  filter(breakdown_of_domestic_tourism == "Expenditure") %>%
  group_by(activity_type) %>%
  summarise(highest_income = sum(value)) %>%
  arrange(desc(highest_income))

```

## Q2.
```{r}
# Which kind of activity generates the most visits to sites?
activities %>%
  filter(breakdown_of_domestic_tourism == "Visits") %>%
  group_by(activity_type) %>%
  summarise(highest_income = sum(value)) %>%
  arrange(desc(highest_income))
```

## Q3. 
```{r}
# Is there a particular key demographic of visitors we should be focusing on?
# as there is no inter-relating data (when you isolate one variable, there is no
# data for the others), I will have to analyse each variable individually.

demographics %>%
  filter(age != "All" & breakdown_of_domestic_tourism == "Visits") %>%
  group_by(age) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))

demographics %>%
  filter(age != "All" & breakdown_of_domestic_tourism != "Visits") %>%
  group_by(age) %>%
  summarise(most_spend = sum(value)) %>%
  arrange(desc(most_spend))

demographics %>%
  filter(marital_status != "All" & breakdown_of_domestic_tourism == "Visits") %>%
  group_by(marital_status) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))

# This doesn't seem very relevant; it's a binary definer. Especially with the younger generation, this may not be very important?

demographics %>%
  filter(gender != "All" & breakdown_of_domestic_tourism == "Visits") %>%
  group_by(gender) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))

# This is pretty much the same as with married. They're pretty even, and I'm not sure they'll matter too much.

demographics %>%
  filter(employment_status != "All" & breakdown_of_domestic_tourism == "Visits") %>%
  group_by(employment_status) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))

# Most people are employed, perhaps not unexpected, as various levels of employment were not available.

demographics %>%
  filter(children != "All" & breakdown_of_domestic_tourism == "Visits") %>%
  group_by(children) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))

# Most people report no to children.

demographics %>%
  filter(access_to_car != "All" & breakdown_of_domestic_tourism == "Visits") %>%
  group_by(access_to_car) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))

# This is an interesting and useful one. Further down, there is a question about travel, and here by far the majority report having access to a car.

demographics %>%
  filter(social_grade != "All" & breakdown_of_domestic_tourism == "Visits") %>%
  group_by(social_grade) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))

# This mostly speaks for itself; the biggest caveat to this is that there was no data dictionary with this dataset, so I can only assume that it goes top down, but this is not known.



```

Q 3.2
```{r}
# Who spends the most?
demographics %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & age != "All") %>%
  group_by(age) %>%
  summarise(highest_spend = sum(value)) %>%
  arrange(desc(highest_spend))

demographics %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & marital_status != "All") %>%
  group_by(marital_status) %>%
  summarise(highest_spend = sum(value)) %>%
  arrange(desc(highest_spend))

demographics %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & gender != "All") %>%
  group_by(gender) %>%
  summarise(highest_spend = sum(value)) %>%
  arrange(desc(highest_spend))

demographics %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & employment_status != "All") %>%
  group_by(employment_status) %>%
  summarise(highest_spend = sum(value)) %>%
  arrange(desc(highest_spend))

demographics %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & children != "All") %>%
  group_by(children) %>%
  summarise(highest_spend = sum(value)) %>%
  arrange(desc(highest_spend))

# The direct answer is people who identify as married - but there are some caveats to this answer. It is only possible to explore one variable at a time, and therefore, the identity of 'married' should be questioned. Additionally, because of the possible survey responses, marital_status only has two choices, whereas age is divided into decades starting at 16. So to best compare, age should be split/merged into two categories, or age is really the only identifier, as it has a range of reasonable options. 
```

Q 3.3
```{r}
# Who visits the most?
demographics %>%
  filter(breakdown_of_domestic_tourism == "Visits" & age != "All") %>%
  group_by(age) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))

demographics %>%
  filter(breakdown_of_domestic_tourism == "Visits" & marital_status != "All") %>%
  group_by(marital_status) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))

demographics %>%
  filter(breakdown_of_domestic_tourism == "Visits" & gender != "All") %>%
  group_by(gender) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))

demographics %>%
  filter(breakdown_of_domestic_tourism == "Visits" & employment_status != "All") %>%
  group_by(employment_status) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))

demographics %>%
  filter(breakdown_of_domestic_tourism == "Visits" & children != "All") %>%
  group_by(children) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))

# Answer here is "no- without children.". But there is the same caveat as with the question above. 
```

## Q4.
```{r}
# What type of locations receive the most visits?
location %>%
  filter(type_of_location_visited != "Other") %>%
  group_by(type_of_location_visited) %>%
  summarise(total_visits = sum(value)) %>%
  arrange(desc(total_visits))

```

Q4.2
```{r}
# What kinds of locations do people spend the most in?
location %>%
  filter(breakdown_of_domestic_tourism == "Expenditure") %>%
  group_by(type_of_location_visited) %>%
  summarise(total_spend = sum(value)) %>%
  arrange(desc(total_spend))
```

## Q5
```{r}
# Is there a particular method of travel our visitors arrive by?
transport %>%
  filter(breakdown_of_domestic_tourism == "Visits" & travel_type != "Other") %>%
  group_by(travel_type) %>%
  summarise(total_visits = sum(value)) %>%
  arrange(desc(total_visits))

# According to my analysis, most people use a car. This is especially underpinned by the demographics, where xx people report having access to a car.

# Note: the question / answer / analysis here from above, from demographics, with access_to_car, would be good to cover under transport.

```

## Q6
```{r}
# When looking at regional tourism, what insights can we gain? 
# How do they differ in
# the money they spend
# nights they spend in Scotland, or
# number of visits they do?

regional_domestic %>%
  filter(breakdown_of_domestic_tourism == "Expenditure") %>%
  group_by(region_of_residence) %>%
  summarise(total_spend = sum(value))

regional_domestic %>%
  filter(breakdown_of_domestic_tourism == "Nights") %>%
  group_by(region_of_residence) %>%
  summarise(total_units = sum(value))
  
regional_domestic %>%
  filter(breakdown_of_domestic_tourism == "Visits") %>%
  group_by(region_of_residence) %>%
  summarise(total_units = sum(value))

# by spend, england is the biggest.
# by nights, england is also the biggest - but the difference between england and scotland is less.
# by visits, scotland is bigger than england. This indicates local visiting.
```

Q 6.1 
```{r}
# Where are our visitors from?
regional_domestic %>%
  group_by(region_of_residence) %>%
  summarise(breakdown_of_visit_countries = sum(value)) %>%
  arrange(desc(breakdown_of_visit_countries))

# Most visitors come from all over GB, i.e. including Wales. (it doesn't state the UK, but GB - but in general terms GB and UK are used interchangably - however, without a data dictionary, I'll have to go by the wording).

regional_domestic %>%
  group_by(region_of_residence, breakdown_of_domestic_tourism) %>%
  summarise(breakdown_of_visit_countries = sum(value))

# This provides a nicer breakdown.
```

## Q7.
```{r}
# What type of accomodation is most popular?
accomodation %>%
  group_by(accommodation_type_and_occupancy) %>%
  summarise(popular_accomodation = sum(value)) %>%
  arrange(desc(popular_accomodation))

# Taking the direct result, is hotels. But I think there are duplicates, somehow so it may need cleaning, and additionally, this is reported in percentage but I've only summed it so I can't report it like this - I'll need to do some further cleaning / wrangling.

# Note: these are reported in percentage; this is important to note on the plots and when talking about the figures

# Note: this is like the demographics; where there is data in one variables, the others have NA, i.e. 'All'.
```

Q 7.1
```{r}
# Is there a difference by location?
accomodation %>%
  filter(location != "Other") %>%
  group_by(location, accommodation_type) %>%
  summarise(popular_accomodation = sum(value)) %>%
  arrange(desc(popular_accomodation))

# So, people are staying in cities.

```

## Q8.
```{r}
# How have general tourism rates changed over time?
activities %>%
  filter(breakdown_of_domestic_tourism == "Visits") %>%
  ggplot(aes(x = year, y = value)) +
  geom_col()

demographics %>%
  filter(breakdown_of_domestic_tourism == "Visits") %>%
  ggplot(aes(x = year, y = value)) +
  geom_col()

location %>%
  filter(breakdown_of_domestic_tourism == "Visits") %>%
  ggplot(aes(x = year, y = value)) +
  geom_col()

# There's a trend of visits increasing in 2017, and declining again.

activities %>%
  filter(breakdown_of_domestic_tourism == "Expenditure") %>%
  ggplot(aes(x = year, y = value)) +
  geom_col()

demographics %>%
  filter(breakdown_of_domestic_tourism == "Expenditure") %>%
  ggplot(aes(x = year, y = value)) +
  geom_col()

location %>%
  filter(breakdown_of_domestic_tourism == "Expenditure") %>%
  ggplot(aes(x = year, y = value)) +
  geom_col()

# Spend is more fluctuating. 

```


### Data visualisations / Plots






## Plot set # 1 - transport
```{r}
# "Is there a particular method of travel our visitors arrive by?".

transport %>%
  filter(breakdown_of_domestic_tourism == "Visits" & travel_type != "Other") %>%
  group_by(travel_type) %>%
  summarise(total_visits = sum(value)) %>%
  ggplot(aes(x = reorder(travel_type, -total_visits), y = total_visits, fill = "blue")) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = "none") +
  labs(x = "Type of transport",
       y = "Total visits (million)",
       title = "Total visits by transport type 2013-2019") +
  scale_fill_manual(values = "#6B085E")

```
These are the sum of million visits in 2019, where visitors reported travelling by X.


```{r}
demographics %>%
  filter(access_to_car != "All" & breakdown_of_domestic_tourism == "Visits") %>%
  group_by(access_to_car) %>%
  summarise(total_car = sum(value)) %>%
  ggplot(aes(x = access_to_car, y = total_car, fill = "blue")) +
  geom_col() +
  theme(legend.position = "none") +
  labs(x = "Year",
       y = "Total visits (million)",
       title = "Visits by demographic (access to car) 2013-2019",
       fill = "Access to car") +
  scale_fill_manual(values = "#6B085E")

```
This is underpinned by the finding that across the the (unit) million visits between 2013 and 2019, the majority of visitors report having access to a car.


## Plot set # 2 - Locations
```{r}
# "what type of locations receive the most visits?"

location %>%
  filter(breakdown_of_domestic_tourism == "Visits"
         & type_of_location_visited != "Other") %>%
  group_by(type_of_location_visited) %>%
  summarise(total_visits = sum(value)) %>%
  ggplot(aes(x = type_of_location_visited, y = total_visits, fill = "blue")) +
  geom_col() +
  theme(legend.position = "none") +
  labs(x = "Type of location",
       y = "Total visits (million)",
       title = "Total visits by type of location 2013-2019") +
  scale_fill_manual(values = "#6B085E")
```
The sum of million visits in 2019 by location. 

```{r}
# "what kinds of locations do people spend the most in?"
location %>%
  filter(breakdown_of_domestic_tourism == "Expenditure"
         & type_of_location_visited != "Other") %>%
  group_by(type_of_location_visited) %>%
  summarise(total_visits = sum(value)) %>%
  ggplot(aes(x = type_of_location_visited, y = total_visits, fill = "blue")) +
  geom_col() +
  theme(legend.position = "none") +
  labs(x = "Type of location",
       y = "Total spend (million £)",
       title = "Total spend by type of location 2013-2019") +
  scale_fill_manual(values = "#6B085E")
```
Sum of spend in 2019 in millions, by location.

```{r}
accomodation %>%
  filter(location != "Other") %>%
  group_by(location, accommodation_type) %>%
  summarise(popular_accomodation = sum(value)/100) %>%
  arrange(desc(popular_accomodation)) %>%
  ggplot(aes(x = location, y = popular_accomodation, fill = "blue")) +
  geom_col() +
  theme(legend.position = "none") +
  labs(x = "Type of location",
       y = "Percentage",
       title = "Average occupancy in accommodation by location type 2013-2019") +
  scale_fill_manual(values = "#6B085E")
```
This lines up with accommodation choices; in 2019, most people chose to visit urban areas.
(note to self: this also answers 'Is there a difference (in accommodation) by location?')
NOTE - this is the one where it's broken down by percentage.


## Plot set # 3 - accommodation
```{r}
# "What type of accomodation is most popular?"

accomodation %>%
  filter(occupancy_type != "Room Occupancy") %>%
  group_by(accommodation_type, occupancy_type) %>%
  summarise(popular_accomodation = sum(value)/100) %>%
  ggplot(aes(x = accommodation_type, y = popular_accomodation, fill = "blue")) +
  geom_col() +
  theme(legend.position = "none") +
  labs(x = "Type of accommodation",
       y = "Percentage",
       title = "Average occupancy by accommodation type 2013-2019") +
  scale_fill_manual(values = "#6B085E")
  
```
2012-2019; percentage occupancy.. ? hotel is by far the highest.

```{r}
accomodation %>%
  filter(location != "Other" & location == "Urban area") %>%
  group_by(location, accommodation_type) %>%
  summarise(popular_accomodation = sum(value)/100) %>%
  arrange(desc(popular_accomodation)) %>%
  ggplot(aes(x = accommodation_type, y = popular_accomodation, fill = accommodation_type)) +
  geom_col(position = "dodge") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(x = "Type of accommodation",
       y = "Percentage",
       title = "Average occupancy by accommodation type for Urban Areas 2013-2019") +
  scale_fill_manual(values = c("Caravan & Camping Parks" = "#905E88",
                               "Guest House/B&B" = "#6B085E",
                               "Hostels" = "#905E88",
                               "Hotels" = "#905E88",
                               "Self Catering" = "#905E88"))

```
2019 data, from location set. When breaking down by location (as above), an interesting finding is that in the urban area, B&B's are just as popular as hotels. Maybe down to a certain B&B site?

```{r}
accomodation %>%
  filter(location == "Urban area" & accommodation_type == "Guest House/B&B") %>%
  group_by(year) %>%
  summarise(popular_accomodation = sum(value)/100) %>%
  ggplot(aes(x = year, y = popular_accomodation)) +
  geom_line() +
  labs(x = "Year",
       y = "Percentage",
       title = "Average occupancy by Urban Area and Guest House/B&B")
```


## Plot set # 4 - activities
```{r}
# What kind of tourism activity generates the highest income?
activities %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & activity_type != "Other") %>%
  group_by(activity_type) %>%
  summarise(highest_income = sum(value)) %>%
  ggplot(aes(x = reorder(activity_type, -highest_income), y = highest_income, fill = "blue")) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = "none") +
  labs(x = "Type of activity",
       y = "Sum of spend (million £)",
       title = "Total spend by activity type 2013-2019") +
  scale_fill_manual(values = "#6B085E")
```
2013-2019, sum of value in million pounds. Highest is eating out (with shopping and visiting family/friends following)

```{r}
# Which kind of activity generates the most visits?
activities %>%
  filter(breakdown_of_domestic_tourism == "Visits" & activity_type != "Other") %>%
  group_by(activity_type) %>%
  summarise(highest_income = sum(value)) %>%
  ggplot(aes(x = reorder(activity_type, -highest_income), y = highest_income, fill = "blue")) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = "none") +
  labs(x = "Type of activity",
       y = "Visits (million)",
       title = "Total visits by activity type 2013-2019") +
  scale_fill_manual(values = "#6B085E")
                      

# this code is to colour the relevant columns separately - but it doesn't run.                      
# c("Shopping" = "#905E88",
#                                "Watch live sports" = "#905E88",
#                                "Night out" = "#905E88",
#                                "Leisure activity" = "#905E88",
#                                "Attend public event" = "#905E88",
#                                "Eating out" = "#905E88",
#                                "Attend personal event" = "#905E88",
#                                "Sports participation" = "#905E88",
#                                "Day out (spa)" = "#905E88",
#                                "Outdoor leisure activity" = "#905E88",
#                                "Visit attraction" = "#905E88",
#                                "Day out" = "#905E88",
#                                "Entertainment - cinema etc." = "#905E88",
#                                "Day trip - leisure" = "#905E88",
#                                "Visit family/friends" = ""))
```
2013-2019, sum of million visits. Highest is visits with family/friends. Eating out coming in second, and outdoor leisure in third.


```{r}
activities %>% 
  filter(breakdown_of_domestic_tourism == "Visits" & activity_type == "Visit family/friends") %>%
  ggplot(aes(x = year, y = value)) +
  geom_line() +
  ylim(1,65)

```



## Plot set # 5 - demographics 


```{r}
# Is there a particular key demographic of visitors we should be focusing on?

demographics %>%
  filter(age != "All" & breakdown_of_domestic_tourism == "Visits") %>%
  group_by(age) %>%
  summarise(most_visits = sum(value)) %>%
  ggplot(aes(x = age, y = most_visits, fill = "blue")) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = "none") +
  labs(x = "Age group",
       y = "Visits (million)",
       title = "Total vists by age group 2013-2019") +
  scale_fill_manual(values = "#6B085E")
```
Yes, and no. The data from this dataset isn't great for analysis, because a lot of inferences have to be drawn. A key insight to be drawn from this is to complete further research / get better data.

With that said - age is a good variable and gives good insights. Across pretty much everything, the reflection from the data is that the younger generations are the ones attending and spending money.

NOTE TO MYSELF - if I have time, dig further into this, across the different years / visits / spends.


```{r}
# breaking the age group by year
demographics %>%
  filter(age == "16-24 years" & breakdown_of_domestic_tourism == "Visits") %>%
  ggplot(aes(x = year, y = value)) +
  geom_line() +
  labs(x = "Year",
       y = "Visits (million)",
       title = "Vists by age 16-24 across 2013 - 2019")
```
```{r}
demographics %>%
  filter(age == "55-64 years" & breakdown_of_domestic_tourism == "Expenditure") %>%
  ggplot(aes(x = year, y = value)) +
  geom_line() +
  labs(x = "Year",
       y = "Spend (million £)",
       title = "Spend by age group 55-64 across 2013 - 2019") 

demographics %>%
  filter(age == "65 years and over" & breakdown_of_domestic_tourism == "Expenditure") %>%
  ggplot(aes(x = year, y = value)) +
  geom_line() +
  labs(x = "Year",
       y = "Visits (million)",
       title = "Spend by age group 65+ across 2013 - 2019")
```


```{r}
# Who spends the most?
demographics %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & marital_status != "All") %>%
  group_by(marital_status) %>%
  summarise(highest_spend = sum(value)) %>%
  ggplot(aes(x = marital_status, y = highest_spend, fill = "blue")) +
  geom_col() +
  theme(legend.position = "none") +
  labs(x = "Is married?",
       y = "Spend (million £)",
       title = "Total spend 2013-2019") +
  scale_fill_manual(values = "#6B085E")
```
This is where the data is limited, because the survey / options for respondents was limited, so marital_status can't really be fairly compared. However, going by the data strictly (because this does still reflect something, and even when grouping age so that they could be compared, the "married" response comes out higher).


```{r}
# Who visits the most?
demographics %>%
  filter(breakdown_of_domestic_tourism == "Visits" & children != "All") %>%
  group_by(children) %>%
  summarise(most_visits = sum(value)) %>%
  ggplot(aes(x = children, y = most_visits, fill = "blue")) +
  geom_col() +
  theme(legend.position = "none") +
  labs(x = "Has children?",
       y = "Visits (million)",
       title = "Total vists 2013-2019") +
  scale_fill_manual(values = "#6B085E")
```
This is the same issue, but also response / relevance, as the above.


```{r}
# code to group the age column into two groups for analysing
demographics %>%
  select(year, value, unit, breakdown_of_domestic_tourism, age) %>%
  filter(breakdown_of_domestic_tourism == "Expenditure") %>%
  mutate(age_category = case_when(age == "16-24 years" ~ "low",
                             age == "25-34 years" ~ "low",
                             age == "35-44 years" ~ "low",
                             age == "45-54 years" ~ "high",
                              age == "54-64 years" ~ "high",
                              age == "65 years and over" ~ "high",
                              age == "All" ~ "Other")) %>%
  filter(age_category == "low") %>%
  summarise(most_visits = sum(value))
  
```
498 (lower half) vs 290 (higher half)


## Plot set # 6 - regional demographics
```{r}
# When looking at regional tourism, what insights can we gain? Where are our visitors from? How do they differ in the money they spend, nights they spend in Scotland, or number of visits they do?

# regional_domestic %>%
#   filter(breakdown_of_domestic_tourism == "Nights") %>%
#   ggplot(aes(x = region_of_residence, y = value, fill = breakdown_of_domestic_tourism)) +
#   geom_col(position = "dodge") +
#   theme(legend.position = "none") +
#   labs(x = "Age group",
#        y = "Sum of visits",
#        title = "Sum of vists distributed across age groups 2013-2019") +
#   scale_fill_manual(values = "#6B085E")
# 
# regional_domestic %>%
#   filter(breakdown_of_domestic_tourism == "Expenditure") %>%
#   ggplot(aes(x = region_of_residence, y = value, fill = breakdown_of_domestic_tourism)) +
#   geom_col(position = "dodge") +
#   theme(legend.position = "none") +
#   labs(x = "Age group",
#        y = "Sum of visits",
#        title = "Sum of vists distributed across age groups 2013-2019") +
#   scale_fill_manual(values = "#6B085E")

regional_domestic %>%
  filter(breakdown_of_domestic_tourism == "Visits") %>%
  ggplot(aes(x = region_of_residence, y = value, fill = breakdown_of_domestic_tourism)) +
  geom_col(position = "dodge") +
  theme(legend.position = "none") +
  labs(x = "Region",
       y = "Visits (million)",
       title = "Total vists by region 2013-2019") +
  scale_fill_manual(values = "#6B085E")
```


## Plot set # 7 - change over time
```{r}
# How have general tourism rates changed over time?

transport %>%
  filter(breakdown_of_domestic_tourism == "Visits") %>%
  group_by(year) %>%
  summarise(total_year = sum(value)) %>%
  ggplot(aes(x = year, y = total_year)) +
  geom_line() +
  theme(legend.position = "none") +
  labs(x = "Year",
       y = "Sum of visits (millions)",
       title = "Tourism rates (by transport, visits) 2013-2019")

demographics %>%
  filter(breakdown_of_domestic_tourism == "Expenditure") %>%
  group_by(year) %>%
  summarise(total_year = sum(value)) %>%
  ggplot(aes(x = year, y = total_year)) +
  geom_line() +
  theme(legend.position = "none") +
  labs(x = "Year",
       y = "Sum of spend (million £)",
       title = "Tourism rates (by demographics, spend) 2013-2019")
```
The *general* picture over time, is that for visits, it increases until 2017, and then declines (some more than others).
For expenditure, it increases until 2017, declines in 2018, and increases again in 2019.

NOTE TO SELF - I should dig into the individual datasets and see if there are any other developments to highlight, if I have time.


### Summary / descriptive statistics for the presentation

Slide 4 - total car users (visits) - transport set
```{r}
transport %>%
  filter(breakdown_of_domestic_tourism == "Visits" & travel_type != "Other") %>%
  summarise(total_value = sum(value))

transport %>%
  filter(breakdown_of_domestic_tourism == "Visits" & travel_type == "Car") %>%
  summarise(total_value = sum(value))

```
65%


```{r}
demographics %>%
  filter(access_to_car == "Access to car (1+)" & breakdown_of_domestic_tourism == "Visits") %>%
  summarise(total_value = sum(value))

demographics %>%
  filter(access_to_car == "No access to car (0)" & breakdown_of_domestic_tourism == "Visits") %>%
  summarise(total_value = sum(value))

demographics %>%
  filter(access_to_car != "All" & breakdown_of_domestic_tourism == "Visits") %>%
  summarise(total_value = sum(value))

```
81.7% report having access to a car
18% report not having access

Slide 5 - total in city/large town (visits) - location
```{r}
location %>%
  filter(breakdown_of_domestic_tourism == "Visits" & type_of_location_visited == "City/large town") %>%
  summarise(total_value = sum(value))

location %>%
  filter(breakdown_of_domestic_tourism == "Visits" & type_of_location_visited != "Other") %>%
  summarise(total_value = sum(value))
```

```{r}
accomodation %>%
  filter(location == "Urban area") %>%
  summarise(total_value = sum(value)/100)

```

Slide 6 - hotels - most popular accommodation 
```{r}
accomodation %>%
  filter(occupancy_type != "Room Occupancy") %>%
  group_by(accommodation_type, occupancy_type) %>%
  summarise(popular_accomodation = sum(value)/100)
```

Slide 7 - b&b - what is the difference otherwise?
```{r}
accomodation %>%
  filter(location != "Other" & location == "Urban area") %>%
  group_by(location, accommodation_type) %>%
  summarise(popular_accomodation = sum(value)/100)
```

Slide 8 - children_no (visits), is_married (spend)
what are the other types?
```{r}
demographics %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & marital_status == "Married") %>%
  summarise(popular_accomodation = sum(value))
23928

demographics %>%
  filter(breakdown_of_domestic_tourism == "Visits" & children == "No - Children") %>%
  summarise(popular_accomodation = sum(value))
683


demographics %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & marital_status != "All") %>%
  summarise(popular_accomodation = sum(value))
35751

demographics %>%
  filter(breakdown_of_domestic_tourism == "Visits" & children != "All") %>%
  summarise(popular_accomodation = sum(value))
940

```
Married - 66.9% spend
No children - 72%

slide 9 - 16-24, (visits)
```{r}
demographics %>%
  filter(breakdown_of_domestic_tourism == "Visits" & age == "16-24 years") %>%
  summarise(popular_accomodation = sum(value))

demographics %>%
  filter(breakdown_of_domestic_tourism == "Visits" & age != "All") %>%
  summarise(popular_accomodation = sum(value))
```

slide 11 - 55-64 and 65+ - spend - number in 2019
```{r}
demographics %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & age == "55-64 years") %>%
  summarise(total = sum(value))
5792

demographics %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & age == "65 years and over") %>%
  summarise(total = sum(value))
5070
```

slide 12 - visits - diff between scot and eng
```{r}
regional_domestic %>%
  filter(breakdown_of_domestic_tourism == "Visits" & region_of_residence == "England") %>%
  summarise(total = sum(value))

109680

regional_domestic %>%
  filter(breakdown_of_domestic_tourism == "Visits" & region_of_residence == "Scotland") %>%
  summarise(total = sum(value))

112132
```
Difference is 2452

slide 13 - eating out - spend; total? percentage? friends/family(visits) - spend/percentage
```{r}
activities %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & activity_type == "Eating out") %>%
  summarise(total = sum(value))

activities %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & activity_type != "Other") %>%
  summarise(total = sum(value))

activities %>%
  filter(breakdown_of_domestic_tourism == "Visits" & activity_type == "Visit family/friends") %>%
  summarise(total = sum(value))

activities %>%
  filter(breakdown_of_domestic_tourism == "Visits" & activity_type != "Other") %>%
  summarise(total = sum(value))
```
Eating out accounts for 13409 million (17.8%)
Visiting family/friends 315 million – 18.5%

### Conclusions





