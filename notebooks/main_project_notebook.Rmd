---
title: "Visit Scotland Final Project"
output: html_notebook
author: "Louise Shambrook"
---

- note to self - structure this document/report similarly to the bikes project

libraries
```{r}
### loading in libraries
library(tidyverse)
library(janitor)
library(lubridate)

```

Exploring the data for each dataset
```{r}
head(domestic_tourism)

domestic_tourism %>%
  filter(Units == "million pounds (GBP)")

# checking for NA values

summary(accomodation)
summary(activities)
summary(demographics)
summary(domestic_tourism)
summary(location)
summary(transport)

head(activities)
head(location)
head(transport)
head(domestic_tourism)
head(accomodation)
```

### Reading in cleaned data

```{r}
activities <- read_csv("clean_data/activities_clean.csv")
accomodation <- read_csv("clean_data/accomodation_clean.csv")
demographics <- read_csv("clean_data/demographics_clean.csv")
location <- read_csv("clean_data/location_clean.csv")
regional_domestic <- read_csv("clean_data/regional_domestic_clean.csv")
transport <- read_csv("clean_data/transport_clean.csv")
```

### Initial analysis -----------------------------------------------------------

Q1.
What kind of tourism activity generates the highest income for Scotland?
```{r}
activities %>%
  filter(breakdown_of_domestic_tourism == "Expenditure") %>%
  group_by(activity_type) %>%
  summarise(highest_income = sum(value)) %>%
  arrange(desc(highest_income))
```
The answer from this analysis, is going out for a meal. 

Which kind of activity generates the most visits to sites?
```{r}
activities %>%
  filter(breakdown_of_domestic_tourism == "Visits") %>%
  group_by(activity_type) %>%
  summarise(highest_income = sum(value)) %>%
  arrange(desc(highest_income))
```

Q3. 
Is there a particular key demographic of visitors we should be focusing on?

as there is no inter-relating data (when you isolate one variable, there is no
data for the others), I will have to analyse each variable individually.

age
```{r}
demographics %>%
  filter(age != "All" & breakdown_of_domestic_tourism == "Visits") %>%
  group_by(age) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))

demographics %>%
  filter(age != "All" & breakdown_of_domestic_tourism != "Visits") %>%
  group_by(age) %>%
  summarise(most_spend = sum(value)) %>%
  arrange(desc(most_spend))

## BREAK THIS ONE DOWN ACROSS TIME
```
Note; I have split this up by visit and spend (as they are in the same column). There isn't much difference in the outcome, but it is important to remember to pick one or the other when reporting the final outcomes.

```{r}
demographics %>%
  filter(marital_status != "All" & breakdown_of_domestic_tourism == "Visits") %>%
  group_by(marital_status) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))
```
This doesn't seem very relevant; it's a binary definer. Especially with the younger generation, this may not be very important?

```{r}
demographics %>%
  filter(gender != "All" & breakdown_of_domestic_tourism == "Visits") %>%
  group_by(gender) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))
```
This is pretty much the same as with married. They're pretty even, and I'm not sure they'll matter too much.

```{r}
demographics %>%
  filter(employment_status != "All" & breakdown_of_domestic_tourism == "Visits") %>%
  group_by(employment_status) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))
```
Most people are employed, perhaps not unexpected, as various levels of employment were not available.

```{r}
demographics %>%
  filter(children != "All" & breakdown_of_domestic_tourism == "Visits") %>%
  group_by(children) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))
```
Most people report no to children.

```{r}
demographics %>%
  filter(access_to_car != "All" & breakdown_of_domestic_tourism == "Visits") %>%
  group_by(access_to_car) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))
```
This is an interesting and useful one. Further down, there is a question about travel, and here by far the majority report having access to a car.

```{r}
demographics %>%
  filter(social_grade != "All" & breakdown_of_domestic_tourism == "Visits") %>%
  group_by(social_grade) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))
```
This mostly speaks for itself; the biggest caveat to this is that there was no data dictionary with this dataset, so I can only assume that it goes top down, but this is not known.


Q3.1 Who spends the most?
```{r}
demographics %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & age != "All") %>%
  group_by(age) %>%
  summarise(highest_spend = sum(value)) %>%
  arrange(desc(highest_spend))

demographics %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & marital_status != "All") %>%
  group_by(marital_status) %>%
  summarise(highest_spend = sum(value)) %>%
  arrange(desc(highest_spend))

demographics %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & gender != "All") %>%
  group_by(gender) %>%
  summarise(highest_spend = sum(value)) %>%
  arrange(desc(highest_spend))

demographics %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & employment_status != "All") %>%
  group_by(employment_status) %>%
  summarise(highest_spend = sum(value)) %>%
  arrange(desc(highest_spend))

demographics %>%
  filter(breakdown_of_domestic_tourism == "Expenditure" & children != "All") %>%
  group_by(children) %>%
  summarise(highest_spend = sum(value)) %>%
  arrange(desc(highest_spend))

```
The direct answer is people who identify as married - but there are some caveats to this answer. It is only possible to explore one variable at a time, and therefore, the identity of 'married' should be questioned. Additionally, because of the possible survey responses, marital_status only has two choices, whereas age is divided into decades starting at 16. So to best compare, age should be split/merged into two categories, or age is really the only identifier, as it has a range of reasonable options. 

Q3.2 Who visits the most?
```{r}
demographics %>%
  filter(breakdown_of_domestic_tourism == "Visits" & age != "All") %>%
  group_by(age) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))

demographics %>%
  filter(breakdown_of_domestic_tourism == "Visits" & marital_status != "All") %>%
  group_by(marital_status) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))

demographics %>%
  filter(breakdown_of_domestic_tourism == "Visits" & gender != "All") %>%
  group_by(gender) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))

demographics %>%
  filter(breakdown_of_domestic_tourism == "Visits" & employment_status != "All") %>%
  group_by(employment_status) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))

demographics %>%
  filter(breakdown_of_domestic_tourism == "Visits" & children != "All") %>%
  group_by(children) %>%
  summarise(most_visits = sum(value)) %>%
  arrange(desc(most_visits))
```
Answer here is "no- without children.". But there is the same caveat as with the question above. 


Q4.
What type of locations receive the most visits? 
```{r}
location %>%
  filter(breakdown_of_domestic_tourism == "Visits") %>%
  group_by(type_of_location_visited) %>%
  summarise(total_visits = sum(value)) %>%
  arrange(desc(total_visits))
```

Q4.1
What kinds of locations do people spend the most in?
```{r}
location %>%
  filter(breakdown_of_domestic_tourism == "Expenditure") %>%
  group_by(type_of_location_visited) %>%
  summarise(total_spend = sum(value)) %>%
  arrange(desc(total_spend))
```


Q5.1
Is there a particular method of travel our visitors arrive by? Some of our locations are remote and not easily accessible by public transport, so this would be good information to have.

NOTE TO SELF - the question / answer / analysis here from above, from demographics, with access_to_car.

```{r}
  mutate(travel_type = 
           case_when(method_of_travel == "Bicycle" ~ "Bicycle",
                     method_of_travel == "Boat/Ship/Ferry" ~ "Boat/Ship/Ferry",
                     method_of_travel == "Bus or Coach - Minibus" ~ "Bus",
                     method_of_travel == "Bus or Coach - Organised Tour" ~ "Bus",
                     method_of_travel == "Bus or Coach - Regular" ~ "Bus",
                     method_of_travel == "Car - hired" ~ "Car",
                     method_of_travel == "Car - own/friends/family" ~ "Car",
                     method_of_travel == "Caravan/Campervan" ~ "Caravan",
                     method_of_travel == "Lorry/Truck/Van" ~ "Lorry",
                     method_of_travel == "Motor cycle" ~ "Motorcycle",
                     method_of_travel == "Other" ~ "Other",
                     method_of_travel == "Plane" ~ "Plane",
                     method_of_travel == "Taxi" ~ "Taxi",
                     method_of_travel == "Train" ~ "Train/Tube/Tram",
                     method_of_travel == "Tram" ~ "Train/Tube/Tram",
                     method_of_travel == "Tube" ~ "Train/Tube/Tram",
                     method_of_travel == "Walked" ~ "Walked",
                     method_of_travel == "All" ~ "Other"))
```


```{r}
transport %>%
  filter(breakdown_of_domestic_tourism == "Visits" & travel_type != "Other") %>%
  group_by(travel_type) %>%
  summarise(total_visits = sum(value)) %>%
  arrange(desc(total_visits))

```
According to my analysis, most people use a car. This is especially underpinned by the demographics, where xx people report having access to a car.


Q6.
When looking at regional tourism, what insights can we gain? How do they differ in
the money they spend
nights they spend in Scotland, or
number of visits they do?

NOTE TO SELF - these can and should be broken down across years

```{r}
regional_domestic %>%
  filter(breakdown_of_domestic_tourism == "Expenditure") %>%
  group_by(region_of_residence) %>%
  summarise(total_spend = sum(value))

regional_domestic %>%
  filter(breakdown_of_domestic_tourism == "Nights") %>%
  group_by(region_of_residence) %>%
  summarise(total_units = sum(value))
  
regional_domestic %>%
  filter(breakdown_of_domestic_tourism == "Visits") %>%
  group_by(region_of_residence) %>%
  summarise(total_units = sum(value))
  
```
Results:
by spend, england is the biggest.
by nights, england is also the biggest - but the difference between england and scotland is less.
by visits, scotland is bigger than england. This indicates local visiting.


Q6.1
Where are our visitors from? 
```{r}
regional_domestic %>%
  group_by(region_of_residence) %>%
  summarise(breakdown_of_visit_countries = sum(value)) %>%
  arrange(desc(breakdown_of_visit_countries))
```
Most visitors come from all over GB, i.e. including Wales. (it doesn't state the UK, but GB - but in general terms GB and UK are used interchangably - however, without a data dictionary, I'll have to go by the wording).


```{r}
regional_domestic %>%
  group_by(region_of_residence, breakdown_of_domestic_tourism) %>%
  summarise(breakdown_of_visit_countries = sum(value))
```
This provides a nicer breakdown.


Q7.
What type of accomodation is most popular? 

Note to self - these are reported in percentage; this is important to note on the plots and when talking about the figures
Second note - this is like the demographics; where there is data in one variables, the others have NA, i.e. 'All'.

```{r}
accomodation %>%
  group_by(accommodation_type_and_occupancy) %>%
  summarise(popular_accomodation = sum(value)) %>%
  arrange(desc(popular_accomodation))

```
Taking the direct result, is hotels. But I think there are duplicates, somehow so it may need cleaning, and additionally, this is reported in percentage but I've only summed it so I can't report it like this - I'll need to do some further cleaning / wrangling.



Q7.1
Is there a difference by location?
```{r}
accomodation %>%
  filter(location != "Other") %>%
  group_by(location) %>%
  summarise(popular_accomodation = sum(value)) %>%
  arrange(desc(popular_accomodation))

```
So, people are staying in cities.


Q8.
How have general tourism rates changed over time?
```{r}

```





## Steps / questions / Plan

- Whilst answering each question, keep an eye out for details / small points - the overall story - remember the bikes project!
- Figure out how to predict spending for visit scotland
- Figure out how to predict visits for visit scotland
    - For these, what are my options? (linear, logistic, decision tree, forest, any others? Maybe clean and prepare the data in R, and then run the model in Python???)


### Main questions to answer --------------------------------------------------

Is there any way to predict spending and visits for Visit Scotland?

### Sub-questions to answer / points to explore, as I go along: