---
title: "Visit Scotland Final Project"
output: html_notebook
author: "Louise Shambrook"
---

- note to self - structure this document/report similarly to the bikes project

libraries
```{r}
### loading in libraries
library(tidyverse)
library(janitor)
library(lubridate)

```


Exploring the data for each dataset
```{r}
head(domestic_tourism)

domestic_tourism %>%
  filter(Units == "million pounds (GBP)")

# checking for NA values

summary(accomodation)
summary(activities)
summary(demographics)
summary(domestic_tourism)
summary(location)
summary(transport)

head(activities)
head(location)
head(transport)
head(domestic_tourism)
head(accomodation)
```


### Reading in cleaned data

```{r}
activities <- read_csv("clean_data/activities_clean.csv")
accomodation <- read_csv("clean_data/accomodation_clean.csv")
demographics <- read_csv("clean_data/demographics_clean.csv")
location <- read_csv("clean_data/location_clean.csv")
regional_domestic <- read_csv("clean_data/regional_domestic_clean.csv")
transport <- read_csv("clean_data/transport_clean.csv")

```

### Initial analysis

Q1.

What kind of tourism activity generates the highest income for Scotland?
```{r}
activities %>%
  filter(breakdown_of_domestic_tourism == "Expenditure") %>%
  group_by(tourism_activity) %>%
  summarise(highest_income = sum(value)) %>%
  arrange(desc(highest_income))
```
The answer from this analysis, is going out for a meal. 


Which kind of activity generates the most visits to sites?
```{r}
activities %>%
  filter(breakdown_of_domestic_tourism == "Visits") %>%
  group_by(tourism_activity) %>%
  summarise(highest_income = sum(value)) %>%
  arrange(desc(highest_income))
```
From this, is going out with friends/family, and then second-highest is going out for a meal.

## ------------------
I'm going to re-run these, with being grouped. They're interesting results - but the guiding question asks what "kind" - and the fact that they're not grouped isn't great.

```{r}
# mutating the dataset
activities_mutated <- activities %>%
  mutate(activity_type = 
           case_when(tourism_activity == "Shopping for items that you do not regularly buy" ~ "Shopping",
                     tourism_activity == "Watched live sporting events (not on TV)" ~ "Attend event (sports)",
                     tourism_activity == "Night out to a bar, pub and/or club" ~ "Going out",
                     tourism_activity == "Special personal events e.g. wedding, graduation" ~ "Attend event (personal)",
                     tourism_activity == "Leisure activities e.g. hobbies & evening classes" ~ "Leisure",
                     tourism_activity == "Sport participation, e.g. exercise classes, gym" ~ "Sports",
                     tourism_activity == "Special public event e.g. festival, exhibition" ~ "Attend event",
                     tourism_activity == "Went out for a meal" ~ "Going out",
                     tourism_activity == "Day out to a beauty/health centre/spa, etc." ~ "Leisure",
                     tourism_activity == "Outdoor leisure activities e.g. walking, golf" ~ "Leisure",
                     tourism_activity == "Visitor attraction e.g. theme park, museum, zoo" ~ "Day trip (visit attractions)",
                     tourism_activity == "General day out/ to explore an area" ~ "Day trip",
                     tourism_activity == "Entertainment - to a cinema, concert or theatre" ~ "Going out",
                     tourism_activity == "Day trips/excursions for other leisure purpose" ~ "Day trip",
                     tourism_activity == "Visited friends or family for leisure" ~ "Visit family/friends",
                     tourism_activity == "All" ~ "Other"))
```



```{r}
# What kind of tourism activity generates the highest income for Scotland?

activities_mutated %>%
  filter(breakdown_of_domestic_tourism == "Expenditure") %>%
  group_by(activity_type) %>%
  summarise(highest_income = sum(value)) %>%
  arrange(desc(highest_income))

# Here, the second highest result is "going out". It's not much different - which I guess is good? It's just a bit more readable.
```

```{r}
#Which kind of activity generates the most visits to sites?

activities_mutated %>%
  filter(breakdown_of_domestic_tourism == "Visits") %>%
  group_by(activity_type) %>%
  summarise(highest_income = sum(value)) %>%
  arrange(desc(highest_income))

# here, the top two are swapped. This is more interesting. 
```

Q3. 
Is there a particular key demographic of visitors we should be focusing on?
```{r}
# examining age

demographics %>%
  filter(age != "All")
```


Q3.1 Who spends the most?
```{r}

```

Q3.2 Who visits the most?
```{r}

```


Q4.
What type of locations receive the most visits? 
```{r}
location %>%
  filter(breakdown_of_domestic_tourism == "Visits") %>%
  group_by(type_of_location_visited) %>%
  summarise(total_visits = sum(value)) %>%
  arrange(desc(total_visits))
```

Q4.1
What kinds of locations do people spend the most in?
```{r}
location %>%
  filter(breakdown_of_domestic_tourism == "Expenditure") %>%
  group_by(type_of_location_visited) %>%
  summarise(total_spend = sum(value)) %>%
  arrange(desc(total_spend))
```


## Steps / questions / Plan


- Begin to complete wrangling so that each question can be answered
- Whilst answering each question, keep an eye out for details / small points - the overall story - remember the bikes project!
- Figure out how to predict spending for visit scotland
- Figure out how to predict visits for visit scotland
    - For these, what are my options? (linear, logistic, decision tree, forest, any others? Maybe clean and prepare the data in R, and then run the model in Python???)


### Main questions to answer --------------------------------------------------



What type of locations receive the most visits? What kinds of locations do people spend the most time in?

Is there a particular method of travel our visitors arrive by? Some of our locations are remote and not easily accessible by public transport, so this would be good information to have.

When looking at regional tourism, what insights can we gain? Where are our visitors from? How do they differ in the money they spend, nights they spend in Scotland, or number of visits they do?

What type of accomodation is most popular? Is there a difference by location?

How have general tourism rates changed over time?

Is there any way to predict spending and visits for Visit Scotland?


### Sub-questions to answer / points to explore, as I go along: